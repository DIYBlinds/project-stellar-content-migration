var e,t;(t=e||(e={})).BOOLEAN="BOOLEAN",t.CURRENCY="CURRENCY",t.GROUP="GROUP",t.LABEL="LABEL",t.MEASUREMENT="MEASUREMENT",t.OUTPUT="OUTPUT",t.QUANTITY="QUANTITY",t.SELECT_MULTI="SELECT_MULTI",t.SELECT_SINGLE="SELECT_SINGLE",t.SET="SET",t.TEXT="TEXT";class i{}class a extends i{constructor(){super()}}class n extends i{constructor(){super()}}class r extends i{constructor(){super()}}class s extends i{}class l extends i{constructor(e,t){super(),this.level=e,this.text=t}}class u{constructor(e){this.option=e,this.hidden=!1,this.removed=!1,this.messages=[]}isHidden(){return this.hidden}isRemoved(){return this.removed}handle(e){if(e instanceof a)this.hidden=!0;else if(e instanceof n)this.hidden=!1,this.removed=!1;else if(e instanceof r)this.removed=!0;else if(e instanceof l)this.messages.push({level:e.level,text:e.text});else throw Error(`not a supported mutation: ${typeof e}`)}}class o extends u{isMandatory(){return this.mandatory}reset(){this.mandatory=this.option.required,this.hidden=!1,this.readonly=!1,this.removed=!1}constructor(e){super(e),this.mandatory=!1,this.readonly=!1,this.mandatory=e.required}handle(e){if(e instanceof s){this.mandatory=!0;return}super.handle(e)}}class d{static getNext(){return`${d.id++}`}}d.id=0;class c{constructor(e){this.id=e,this.sortOrder=-1,this.name=null,this.messages=[]}setSortOrder(e){return this.sortOrder=e,this}setName(e){return this.name=e,this}setMeta(e){return this.meta=e,this}setMessages(e){return this.messages=e,this}}class h extends c{constructor(e){super(e),this.mandatory=!1,this.readonly=!1}setMandatory(e){return this.mandatory=e,this}setReadonly(e){return this.readonly=e,this}}class m extends h{constructor(e){super(e),this.currentValue=0,this.minimum=null,this.maximum=null,this.step=null}setCurrentValue(e){return this.currentValue=e,this}setMinimum(e){return this.minimum=e,this}setMaximum(e){return this.maximum=e,this}setStep(e){return this.step=e,this}render(){return{id:this.id,name:this.name,sortOrder:this.sortOrder,mandatory:this.mandatory,meta:this.meta,type:e.CURRENCY,value:this.currentValue,readonly:this.readonly,messages:this.messages,minimum:this.minimum,maximum:this.maximum,step:this.step}}}class p extends c{constructor(e,t){super(e),this.fields=t}render(){return{id:this.id,type:e.SET,name:this.name,sortOrder:this.sortOrder,meta:this.meta,fields:this.fields,messages:this.messages}}}class f extends h{constructor(e){super(e),this.multiline=!1,this.currentValue=""}setMultiline(e){return this.multiline=e,this}setCurrentValue(e){return this.currentValue=e,this}render(){return{id:this.id,name:this.name,sortOrder:this.sortOrder,mandatory:this.mandatory,meta:this.meta,type:e.TEXT,multiline:this.multiline,value:this.currentValue,readonly:this.readonly,messages:this.messages}}}class b extends o{getSetters(){return new Map([[this.textFieldId,e=>this.setValue(e)],[this.priceFieldId,e=>this.setPrice(e)]])}constructor(e){var t;super(e),this.textFieldId=d.getNext(),this.priceFieldId=d.getNext(),this.currentValue=null,this.price=null,this.currentValue=null!==(t=e.default)&&void 0!==t?t:""}hasValue(){return null!=this.currentValue&&""!=this.currentValue.trim()}hasValidValue(){var e;return!(this.isMandatory()||this.hasValue())||!((null!==(e=this.currentValue)&&void 0!==e?e:"").length>this.option.maxLength)&&!0}reset(){}clone(){let e=new b(this.option);return e.hidden=this.hidden,e.readonly=this.readonly,e.mandatory=this.mandatory,e.currentValue=this.currentValue,e}setValue(e){this.currentValue=e}getValue(){return this.currentValue}setPrice(e){this.price=e}render(){var e,t;let i=new f(this.textFieldId).setName(this.option.name).setMultiline(this.option.multiline).setMandatory(this.mandatory).setReadonly(this.readonly).setCurrentValue(null!==(t=null!==(e=this.currentValue)&&void 0!==e?e:this.option.default)&&void 0!==t?t:"").setSortOrder(this.option.sortOrder).setMeta(null).render();if(!this.option.hasPrice)return i;let a=new m(this.priceFieldId).setMandatory(this.mandatory).setReadonly(this.readonly).setSortOrder(this.option.sortOrder).setCurrentValue(this.price).setMinimum(0).setMeta(null).render();return new p(this.option.id,[i,a]).render()}buildDisplayComponent(){var e;return{name:this.option.name,value:null!==(e=this.currentValue)&&void 0!==e?e:"",sortOrder:this.option.sortOrder}}snapshot(){return{id:this.option.id,type:"TEXT",name:this.option.name,legacyId:this.option.legacyId,value:this.currentValue,price:this.price}}restore(e){this.currentValue=e.value,this.option.hasPrice?this.price=e.price:this.price=null}}class y extends i{constructor(e){super(),this.optionSelectIds=e}}class g extends i{constructor(e){super(),this.optionSelectIds=e}}class O extends i{constructor(e){super(),this.optionSelectIds=e}}class I extends i{constructor(e){super(),this.optionSelectIds=e}}class S extends c{constructor(e,t){super(e),this.value=t}render(){return{id:this.id,name:this.value,sortOrder:this.sortOrder,meta:this.meta,type:e.LABEL,messages:this.messages}}}class E extends h{constructor(e){super(e),this.currentValue=null,this.minimum=null,this.maximum=null,this.step=null}setCurrentValue(e){return this.currentValue=e,this}setMinimum(e){return this.minimum=e,this}setMaximum(e){return this.maximum=e,this}setStep(e){return this.step=e,this}render(){return{id:this.id,name:this.name,sortOrder:this.sortOrder,mandatory:this.mandatory,meta:this.meta,type:e.QUANTITY,value:this.currentValue,readonly:this.readonly,messages:this.messages,minimum:this.minimum,maximum:this.maximum,step:this.step}}}class T extends c{constructor(e,t){super(e),this.fields=t}render(){return{id:this.id,type:e.GROUP,name:this.name,sortOrder:this.sortOrder,meta:this.meta,fields:this.fields,messages:this.messages}}}class V extends h{constructor(e){super(e),this.currentValues=[],this.options=[],this.minSelected=null,this.maxSelected=null}setOptions(e){return this.options=e,this}setCurrentValue(e){return this.currentValues=e,this}setMinSelectedValue(e){return this.minSelected=e,this}setMaxSelectedValue(e){return this.maxSelected=e,this}render(){return{id:this.id,name:this.name,sortOrder:this.sortOrder,mandatory:this.mandatory,meta:this.meta,type:e.SELECT_MULTI,options:this.options,selectedOptions:this.currentValues,readonly:this.readonly,messages:this.messages,minSelected:this.minSelected,maxSelected:this.maxSelected}}}class M extends i{constructor(e){super(),this.readOnly=e}}class C extends o{constructor(e){super(e),this.selectLookup=new Map,this.currentValue=[],this.hiddenOptionSelects=new Set,this.optionSelectWithQuantityFieldIdLookup=new Map,this.selectFieldId=d.getNext(),this.selects=this.option.selects.map(e=>({id:e.id,name:e.name,sortOrder:e.sortOrder,meta:e.meta})),this.option.selects.forEach(e=>{this.selectLookup.set(e.id,e),this.option.defaultIds.includes(e.id)&&this.currentValue.push(new v(e.id))})}getSetters(){let e=new Map([[this.selectFieldId,e=>this.setValue(e)]]);return this.option.selects.filter(e=>e.hasQuantity).forEach(t=>{let i=d.getNext();this.optionSelectWithQuantityFieldIdLookup.set(t.id,i),e.set(i,e=>this.setSelectOptionQuantity(t.id,e))}),e}getValue(){return this.currentValue}hasValue(){return null!=this.currentValue&&this.currentValue.length>0}hasValidValue(){return!(this.isMandatory()||this.hasValue())||(null==this.option.minSelected||!(this.currentValue.length<this.option.minSelected))&&(null==this.option.maxSelected||!(this.currentValue.length>this.option.maxSelected))&&!0}reset(){super.reset(),this.hiddenOptionSelects=new Set}clone(){let e=new C(this.option);return e.hidden=this.hidden,e.readonly=this.readonly,e.mandatory=this.mandatory,e.currentValue=this.currentValue,e.hiddenOptionSelects=this.hiddenOptionSelects,e}handle(e){e instanceof y?e.optionSelectIds.forEach(e=>this.hiddenOptionSelects.add(e)):e instanceof g?e.optionSelectIds.forEach(e=>this.hiddenOptionSelects.delete(e)):e instanceof O?(e.optionSelectIds.forEach(t=>{if(this.currentValue.find(e=>e.id===this.selectLookup.get(t).id))return;let i=this.selectLookup.get(t);i.hasQuantity?this.currentValue.push(new N(i.id,null)):this.currentValue.push(new v(this.selectLookup.get(t).id)),this.option.selects.filter(t=>!e.optionSelectIds.includes(t.id)).forEach(e=>this.hiddenOptionSelects.add(e.id))}),this.readonly=!0):e instanceof I?(e.optionSelectIds.forEach(e=>{this.currentValue.push(new v(this.selectLookup.get(e).id))}),this.readonly=!1):e instanceof M?this.readonly=e.readOnly:super.handle(e)}buildDisplayComponent(){let e=this.currentValue.map(e=>{var t,i;return null!==(i=null===(t=this.selectLookup.get(e.id))||void 0===t?void 0:t.name)&&void 0!==i?i:""}).join(", ");return{name:this.option.name,value:e,sortOrder:this.option.sortOrder}}setValue(e){0===e.length&&(this.currentValue=[]);let t=new Map(this.currentValue.map(e=>[e.id,e])),i=[];e.forEach(e=>{let a=t.get(e);if(a)i.push(a);else{let t=this.selectLookup.get(e);if(!t)throw Error("not a valid selection");t.hasQuantity?i.push(new N(t.id,null)):i.push(new v(t.id))}this.currentValue=i})}setSelectOptionQuantity(e,t){let i=this.selectLookup.get(e);if(!i||!i.hasQuantity)throw Error("not a valid selection / cant set a quantity");let a=this.currentValue.find(t=>t.id===e);a?a.quantity=t:this.currentValue.push(new N(e,t))}render(){let e=this.selects.filter(e=>!this.hiddenOptionSelects.has(e.id)),t=this.currentValue.map(t=>e.find(e=>e.id===t.id)),i=this.currentValue.filter(e=>e instanceof N),a=new V(this.selectFieldId).setName(this.option.name).setOptions(e).setCurrentValue(t).setMandatory(this.mandatory).setReadonly(this.readonly).setSortOrder(this.option.sortOrder).setMeta(this.option.meta).render();if(0===i.length)return a;let n=i.map((e,t)=>{let i=this.optionSelectWithQuantityFieldIdLookup.get(e.id),a=new S(`${i}-LABEL`,this.selectLookup.get(e.id).name).setSortOrder(0).render(),n=new E(i).setMandatory(!0).setReadonly(!1).setSortOrder(1).setCurrentValue(e instanceof N?e.quantity:null).render();return new p(e.id,[a,n]).setSortOrder(t).render()});return new T(this.option.id,[a,...n]).render()}snapshot(){let e=this.currentValue.map(e=>{let t=this.selectLookup.get(e.id);return{id:e.id,legacyId:t.legacyId,manufacturerKey:t.manufacturerKey,name:t.name,hasQuantity:t.hasQuantity,quantity:e instanceof N?e.quantity:null}});return{id:this.option.id,type:"SELECT_MULTI",legacyId:this.option.legacyId,name:this.option.name,values:e}}restore(e){let t=e.values.map(e=>e.id);for(let i=0;i<t.length;i++){let a=this.selectLookup.get(t[i]),n=e.values[i];a.hasQuantity?this.currentValue.push(new N(a.id,n.quantity)):this.currentValue.push(new v(a.id))}}}class v{constructor(e){this.id=e}}class N extends v{constructor(e,t){super(e),this.quantity=t}}class R extends h{constructor(e){super(e),this.currentValue=null,this.options=[]}setOptions(e){return this.options=e,this}setCurrentValue(e){return this.currentValue=e,this}render(){return{id:this.id,name:this.name,sortOrder:this.sortOrder,mandatory:this.mandatory,meta:this.meta,type:e.SELECT_SINGLE,options:this.options,selectedOption:this.currentValue,readonly:this.readonly,messages:this.messages}}}class L extends o{constructor(e){super(e),this.selectFieldId=d.getNext(),this.selectLookup=new Map,this.optionSelectWithQuantityFieldIdLookup=new Map,this.currentValue=null,this.hiddenOptionSelects=new Set,this.selects=this.option.selects.map(e=>({id:e.id,name:e.name,sortOrder:e.sortOrder,meta:e.meta})),this.option.selects.forEach(e=>{this.selectLookup.set(e.id,e),this.option.defaultId==e.id&&(e.hasQuantity?this.currentValue=new N(e.id,null):this.currentValue=new v(e.id))})}getValue(e){return null===this.currentValue||!e&&this.hiddenOptionSelects.has(this.currentValue.id)?null:this.selects.find(e=>e.id===this.currentValue.id)}hasValue(){return null!=this.currentValue}hasValidValue(){return!this.isMandatory()&&this.hasValue(),!0}reset(){super.reset(),this.hiddenOptionSelects=new Set}clone(){let e=new L(this.option);return e.hidden=this.hidden,e.readonly=this.readonly,e.mandatory=this.mandatory,e.currentValue=this.currentValue,e.hiddenOptionSelects=this.hiddenOptionSelects,e}getSetters(){let e=new Map([[this.selectFieldId,e=>this.setValue(e)]]);return this.option.selects.filter(e=>e.hasQuantity).forEach(t=>{let i=d.getNext();this.optionSelectWithQuantityFieldIdLookup.set(t.id,i),e.set(i,e=>this.setSelectOptionQuantity(t.id,e))}),e}handle(e){if(e instanceof y)e.optionSelectIds.forEach(e=>this.hiddenOptionSelects.add(e));else if(e instanceof g)e.optionSelectIds.forEach(e=>this.hiddenOptionSelects.delete(e));else if(e instanceof O){if(e.optionSelectIds.length>1)throw Error("cant auto select multiple on a single");this.selectLookup.get(e.optionSelectIds[0])&&(this.currentValue=new v(e.optionSelectIds[0]),this.readonly=!0,this.hiddenOptionSelects.clear(),this.option.selects.filter(t=>t.id!=e.optionSelectIds[0]).forEach(e=>this.hiddenOptionSelects.add(e.id)))}else if(e instanceof I){if(e.optionSelectIds.length>1)throw Error("cant auto select multiple on a single");this.selectLookup.get(e.optionSelectIds[0])&&(this.currentValue=new v(e.optionSelectIds[0])),this.readonly=!1}else e instanceof M?this.readonly=e.readOnly:super.handle(e)}buildDisplayComponent(){var e,t;let i="";return this.currentValue&&(i=null!==(t=null===(e=this.selectLookup.get(this.currentValue.id))||void 0===e?void 0:e.name)&&void 0!==t?t:""),{name:this.option.name,value:i,sortOrder:this.option.sortOrder}}setValue(e){if(null===e){this.currentValue=null;return}let t=this.selectLookup.get(e);if(!t)throw Error("not a valid selection");if(null===this.currentValue||this.currentValue.id!==t.id)t.hasQuantity?this.currentValue=new N(t.id,null):this.currentValue=new v(t.id)}setSelectOptionQuantity(e,t){var i;let a=this.selectLookup.get(e);if(!a||!a.hasQuantity)throw Error("not a valid selection / cant set a quantity");(null===(i=this.currentValue)||void 0===i?void 0:i.id)===e?this.currentValue.quantity=t:this.currentValue=new N(e,t)}render(){var e;let t=this.selects.filter(e=>!this.hiddenOptionSelects.has(e.id)),i=null!==(e=t.find(e=>{var t;return e.id===(null===(t=this.currentValue)||void 0===t?void 0:t.id)}))&&void 0!==e?e:null,a=this.currentValue instanceof N,n=new R(this.selectFieldId).setName(this.option.name).setOptions(t).setCurrentValue(i).setMandatory(this.mandatory).setReadonly(this.readonly).setSortOrder(this.option.sortOrder).setMeta(this.option.meta).render();if(!a)return n;let r=this.optionSelectWithQuantityFieldIdLookup.get(this.currentValue.id),s=new S(`${r}-LABEL`,this.selectLookup.get(this.currentValue.id).name).setSortOrder(0).render(),l=new E(r).setMandatory(!0).setReadonly(!1).setSortOrder(1).setCurrentValue(this.currentValue instanceof N?this.currentValue.quantity:null).render(),u=new p(this.currentValue.id,[s,l]).setSortOrder(this.option.sortOrder+1).render();return new T(this.option.id,[n,u]).render()}snapshot(){var e;let t=null!=this.currentValue&&null!==(e=this.selectLookup.get(this.currentValue.id))&&void 0!==e?e:null,i=t instanceof N?t.quantity:null,a=null;return t&&(a={id:t.id,name:t.name,hasQuantity:t.hasQuantity,manufacturerKey:t.manufacturerKey,legacyId:t.legacyId,quantity:i}),{id:this.option.id,legacyId:this.option.legacyId,type:"SELECT_SINGLE",name:this.option.name,value:a}}restore(e){var t,i,a,n;let r=null===(t=e.value)||void 0===t?void 0:t.id;r&&(this.currentValue=null!==(i=this.selectLookup.get(r))&&void 0!==i?i:null,(null===(a=e.value)||void 0===a?void 0:a.quantity)&&this.currentValue instanceof N&&(this.currentValue=new N(r,null===(n=e.value)||void 0===n?void 0:n.quantity)))}}class x extends h{constructor(e){super(e),this.currentValue=0,this.minimum=null,this.maximum=null,this.step=null,this.unit="MM"}setCurrentValue(e){return this.currentValue=e,this}setMinimum(e){return this.minimum=e,this}setMaximum(e){return this.maximum=e,this}setStep(e){return this.step=e,this}setUnit(e){return this.unit=e,this}render(){return{id:this.id,name:this.name,sortOrder:this.sortOrder,mandatory:this.mandatory,meta:this.meta,type:e.MEASUREMENT,value:this.currentValue,readonly:this.readonly,messages:this.messages,minimum:this.minimum,maximum:this.maximum,step:this.step,unit:this.unit}}}class P extends o{constructor(e){super(e),this.measurementFieldId=d.getNext(),this.currentValue=null,this.currentValue=e.value}reset(){}hasValue(){return null!=this.currentValue}hasValidValue(){return!this.isMandatory()&&this.hasValue(),!0}clone(){let e=new P(this.option);return e.hidden=this.hidden,e.readonly=this.readonly,e.mandatory=this.mandatory,e.currentValue=this.currentValue,e}getSetters(){return new Map([[this.measurementFieldId,e=>this.setValue(e)]])}setValue(e){null!=e?"number"==typeof e?this.currentValue=e:this.currentValue=parseFloat(e):this.currentValue=null}getValue(){return this.currentValue}handle(e){super.handle(e)}buildDisplayComponent(){var e,t;return{name:this.option.name,value:null!==(t=null===(e=this.currentValue)||void 0===e?void 0:e.toFixed(0))&&void 0!==t?t:"0",sortOrder:this.option.sortOrder}}render(){var e;return new x(this.measurementFieldId).setName(this.option.name).setMandatory(this.mandatory).setReadonly(this.readonly).setSortOrder(this.option.sortOrder).setStep(this.option.step).setMaximum(this.option.maximum).setMinimum(null!==(e=this.option.minimum)&&void 0!==e?e:0).setCurrentValue(this.currentValue).setMeta(this.option.meta).render()}snapshot(){return{type:"MEASUREMENT",id:this.option.id,name:this.option.name,legacyId:this.option.legacyId,value:this.currentValue}}restore(e){this.currentValue=e.value}}class F extends u{constructor(e){super(e)}clone(){let e=new F(this.option);return e.hidden=this.hidden,e}render(){throw Error("Method not implemented.")}}class D extends i{constructor(e,t){super(),this.min=e,this.max=t}}class A{}class w extends A{constructor(e){super(),this.value=e}}class U{constructor(e){this.config=e}}class _{}class W extends i{constructor(e){super(),this.value=e}}class H extends A{constructor(e){super(),this.pricingConfig=e}}class G extends A{constructor(e,t,i){super(),this.name=e,this.minimum=t,this.maximum=i}}class K extends A{constructor(e){super(),this.modifier=e}}class k extends A{constructor(e){super(),this.modifier=e}}class Q{constructor(e,t,i){this.productConfig=e,this.modelState=t,this.engine=i,this.ceil=Math.ceil,this.floor=Math.floor,this.round=Math.round}setNumericVariableMinMax(e,t,i){this.modelState.addModelMutation(new G(e,t,i))}overrideMinMaxForOption(e,t,i){this.modelState.addOptionMutation(e,new D(t,i))}selectOptionForceSelect(e,t){this.modelState.addOptionMutation(e,new O(t))}selectOptionDefaultSelect(e,t){this.modelState.addOptionMutation(e,new I(t))}showSelectFieldOption(e,t){this.modelState.addOptionMutation(e,new g(t))}hideSelectFieldOption(e,t){this.modelState.addOptionMutation(e,new y(t))}showOption(e){this.modelState.addOptionMutation(e,new n)}hideOption(e){this.modelState.addOptionMutation(e,new a)}setOptionReadOnly(e,t){this.modelState.addOptionMutation(e,new M(t))}removeOption(e){this.modelState.addOptionMutation(e,new r)}setOptionRequired(e){this.modelState.addOptionMutation(e,new s)}addOptionMessage(e,t,i){this.modelState.addMessage({level:t,text:i}),this.modelState.addOptionMutation(e,new l(t,i))}addOptionPropertyMessage(e,t,i){throw Error("Method not implemented.")}addMessage(e,t){this.modelState.addMessage({level:e,text:t})}updateStringVariable(e,t){this.modelState.setVariableValue(e,t)}optionHasValue(e){return this.modelState.optionHasValue(e)}optionHasValidValue(e){return this.modelState.optionHasValidValue(e)}updateNumericVariable(e,t){this.modelState.setVariableValue(e,t)}updateBooleanVariable(e,t){this.modelState.setVariableValue(e,t)}log(e){console.log(e)}getOptionNumericValue(e){var t;return null!==(t=this.modelState.getOptionValue(e))&&void 0!==t?t:0}getOptionTextValue(e){return this.modelState.getOptionValue(e)}restoreOptionSnapshot(e){this.modelState.restoreOption(e)}snapshotOption(e){return this.modelState.buildOptionSnapshot(e)}getVariableByName(e){return this.modelState.getVariableValue(e)}getPriceGrid(e){return this.modelState.getPriceGridById(e)}getDate(){return Date.now()}anyOptionSelected(e,t,i){let a=this.modelState.getOptionValue(e,i);return!!a&&a.some(e=>t.includes(e.id))}adjustSellPrice(e){this.modelState.addModelMutation(new w(e))}setPricingMode(e){this.modelState.addModelMutation(new H(e))}addBasePriceModifier(e){this.modelState.addModelMutation(new K(e))}addOptionPriceModifier(e){this.modelState.addModelMutation(new k(e))}setDisplayOptionValue(e,t){this.modelState.addOptionMutation(e,new W(t))}setVariableValue(e,t){this.modelState.setVariableValue(e,t)}getValueByCalculationKey(e){return this.modelState.getValueByCalculationKey(e)}getIntervalPartMapping(e,t){var i;return null!==(i=t.find(t=>t[0]<=e))&&void 0!==i?i:t[t.length-1]}loadSubProduct(e){this.modelState.addModelMutation(new U(e))}unloadSubProduct(){this.modelState.addModelMutation(new _)}getSubEngineContext(){return this.engine.getSubEngineExecutionContext()}getInputOptionSnapshot(e){return this.modelState.buildOptionSnapshot(e)}restoreInputOptionSnapshot(e){var t;this.productConfig.meta.attributes.optionSyncPassthrough?null===(t=this.getSubEngineContext())||void 0===t||t.restoreInputOptionSnapshot(e):this.modelState.restoreOption(e)}restoreInputOptionSnapshotIfEmpty(e){var t;this.productConfig.meta.attributes.optionSyncPassthrough?null===(t=this.getSubEngineContext())||void 0===t||t.restoreInputOptionSnapshotIfEmpty(e):!this.modelState.optionHasValidValue(e.id)&&this.modelState.restoreOption(e)}updateVariableMaximumsFromPriceGrid(e){let t=this.modelState.getPriceGridById(e);if(null==t)throw Error(`price grid: ${e} not found`);let i=t.xSpacings[t.xSpacings.length-1];if(this.setNumericVariableMinMax(t.xVariable,null,i),null!=t.yVariable){let e=t.ySpacings[t.ySpacings.length-1];this.setNumericVariableMinMax(t.yVariable,null,e)}}}class Y extends u{constructor(e){var t;super(e),this.currentValue=null,this.currentValue=null!==(t=e.value)&&void 0!==t?t:""}clone(){let e=new Y(this.option);return e.hidden=this.hidden,e.currentValue=this.currentValue,e}setValue(e){this.currentValue=e}render(){return new S(this.option.id,this.option.value).setSortOrder(this.option.sortOrder).setMeta(null).render()}handle(e){e instanceof W?this.currentValue=e.value:super.handle(e)}snapshot(){return{type:"DISPLAY",id:this.option.id,name:this.option.name,legacyId:this.option.legacyId,value:this.currentValue}}restore(e){this.currentValue=e.value}}class B extends o{constructor(e){super(e),this.numberFieldId=d.getNext(),this.currentValue=null,this.currentValue=e.value}clone(){let e=new B(this.option);return e.hidden=this.hidden,e.readonly=this.readonly,e.mandatory=this.mandatory,e.currentValue=this.currentValue,e}reset(){}hasValue(){return null!=this.currentValue}hasValidValue(){var e,t;if(!this.isMandatory()&&!this.hasValue())return!0;let i=null!==(e=this.currentValue)&&void 0!==e?e:0;return(null==this.option.minimum||!(i<this.option.minimum))&&(null==this.option.maximum||!(i>this.option.maximum))&&(null==this.option.step||(i-(null!==(t=this.option.minimum)&&void 0!==t?t:0))%this.option.step==0)&&!0}getSetters(){return new Map([[this.numberFieldId,e=>this.setValue(e)]])}setValue(e){this.currentValue=e}getValue(){return this.currentValue}handle(e){super.handle(e)}buildDisplayComponent(){var e,t;return{name:this.option.name,value:null!==(t=null===(e=this.currentValue)||void 0===e?void 0:e.toFixed(0))&&void 0!==t?t:"0",sortOrder:this.option.sortOrder}}render(){return new E(this.numberFieldId).setName(this.option.name).setMandatory(this.mandatory).setReadonly(this.readonly).setSortOrder(this.option.sortOrder).setStep(this.option.step).setMaximum(this.option.maximum).setMinimum(this.option.minimum).setCurrentValue(this.currentValue).setMeta(null).render()}snapshot(){return{type:"NUMERIC",id:this.option.id,name:this.option.name,legacyId:this.option.legacyId,value:this.currentValue}}restore(e){this.currentValue=e.value}}class q{constructor(e,t,i){this.productConfig=e,this.environment=t,this.initialValues=i,this.optionState=new Map,this.optionParentLookup=new Map,this.variableLookup=new Map,this.priceGridLookup=new Map,this.optionLookup=new Map,this.modelMutations=[],this.basePriceModifiers=[],this.optionPriceModifiers=[],this.messages=[],this.subProductConfig=null,this.pricingConfigOverride=null,e.priceGrids.forEach(e=>this.priceGridLookup.set(e.id,e)),this.buildOptionLookup(e.options,null),e.variables.forEach(e=>{this.variableLookup.set(e.name,Object.assign({},e))}),this.buildOptionState(),this.optionByCalculationKeyLookup=this.buildOptionByCalculationKeyLookup(),this.fieldStateSetters=this.getSetters(),this.setInitialValues(),this.setInitialValues()}getProductId(){return this.productConfig.meta.id}setInitialValues(){var e;if(this.initialValues){let t=Object.keys(this.initialValues);if(0===t.length)return;let i=null!==(e=this.productConfig.initialValues)&&void 0!==e?e:[];for(let e of t){let t=i.find(t=>t.key===e);if(!t)throw Error(`no initial value schema found ${e}`);let a=this.variableLookup.get(t.key);if(!a||"SYSTEM"!==a.type)throw Error(`no variable found for initial value schema ${e}`);let n=this.initialValues[e];void 0!==n&&this.setVariableValue(a.name,n)}}}getSetters(){let e=new Map;return this.optionState.forEach(t=>{t instanceof o&&t.getSetters().forEach((t,i)=>{e.set(i,t)})}),e}resetForEvaluation(){this.messages=[],this.modelMutations=[],this.basePriceModifiers=[],this.optionPriceModifiers=[],this.subProductConfig=null,this.pricingConfigOverride=null,this.setInitialValues(),this.optionState.forEach(e=>{e instanceof o&&e.reset()});let e=this.productConfig.variables.filter(e=>"SYSTEM"===e.type&&"NUMERIC"===e.dataType);if(this.variableLookup.forEach(t=>{if("SYSTEM"!=t.type||"NUMERIC"!==t.dataType)return;let i=e.find(e=>e.name===t.name);if(!!i)t.maximum=i.maximum,t.minimum=i.minimum}),"PRICE_GRID"==this.productConfig.pricing.mode.type){let e=this.priceGridLookup.get(this.productConfig.pricing.mode.priceGridId);this.setMaximumMinFromPriceGrid(e)}}buildOptionLookup(e,t){e.forEach(e=>{this.optionLookup.set(e.id,e),t&&this.optionParentLookup.set(e.id,t),"GROUP"===e.type&&this.buildOptionLookup(e.subOptions,e.id)})}buildOptionByCalculationKeyLookup(){let e=new Map;for(let t of this.optionState.values()){if(!t.option.calculationKey)continue;let i=e.get(t.option.calculationKey);!i&&(i=[],e.set(t.option.calculationKey,i)),i.push(t)}return e}buildOptionState(){this.optionLookup.forEach(e=>{switch(e.type){case"TEXT":this.optionState.set(e.id,new b(e));break;case"DISPLAY":this.optionState.set(e.id,new Y(e));break;case"SELECT_SINGLE":this.optionState.set(e.id,new L(e));break;case"SELECT_MULTI":this.optionState.set(e.id,new C(e));break;case"MEASUREMENT":this.optionState.set(e.id,new P(e));break;case"NUMERIC":this.optionState.set(e.id,new B(e));break;case"GROUP":this.optionState.set(e.id,new F(e))}})}hasField(e){return this.fieldStateSetters.has(e)}getOptionValue(e,t){let i=this.optionState.get(e);if(!t&&this.optionIsRemoved(e))return null;if(i instanceof L){let e=i.getValue(t);if(e)return[e]}else if(i instanceof C)return i.getValue();else if(i instanceof P)return i.getValue();return null}renderOption(e){let t=this.optionState.get(e);if(t)return this.isOptionVisible(e)?t.render():null;throw Error("no option found")}getVariableValue(e){let t=this.variableLookup.get(e);if(!t)throw Error(`no variable found \`${e}\``);switch(t.type){case"USER":case"SYSTEM":return t.value;case"COMPUTED":return t.calculate(new Q(this.productConfig,this,null));default:throw Error("unknown variable type")}}getNumericVariable(e){return this.variableLookup.get(e)}optionHasValue(e){let t=this.optionState.get(e);return!!t&&t instanceof o&&t.hasValue()}optionHasValidValue(e){let t=this.optionState.get(e);return!!t&&t instanceof o&&t.hasValidValue()}setVariableValue(e,t){let i=this.variableLookup.get(e);if(i){if("USER"===i.type||"SYSTEM"===i.type)switch(i.dataType){case"STRING":i.value=t;break;case"NUMERIC":"number"!=typeof t&&(t=parseFloat(t)),i.value=t;break;case"BOOLEAN":i.value=!!t;break;case"ENUM":if(-1===i.values.indexOf(t))throw Error(`invalid value ${t} for enum ${i.name}`);i.value=t;break;case"ANY":i.value=t}else throw Error(`cannot set value ${t} for variable ${e} of type ${i.type}`)}else{let i={name:e,type:"USER",dataType:"ANY",value:t};this.variableLookup.set(e,i)}}getValueByCalculationKey(e){if(this.variableLookup.has(e))return this.getVariableValue(e);let t=this.optionByCalculationKeyLookup.get(e);if(!t)return;let i=t[0];if(t.length>1){let a=t.filter(e=>!this.optionIsRemoved(e.option.id));if(a.length>1)throw Error(`multiple options not marked as removed found for key: ${e}`);if(0===a.length)return;i=a[0]}switch(i.option.type){case"SELECT_MULTI":let a=i;return a.getValue().map(e=>e.id).map(e=>a.option.selects.find(t=>t.id===e).manufacturerKey);case"SELECT_SINGLE":let n=i,r=n.getValue();if(r)return n.option.selects.find(e=>e.id===(null==r?void 0:r.id)).manufacturerKey;return null;case"MEASUREMENT":case"NUMERIC":case"TEXT":return i.getValue()}}setTextFieldValue(e,t){let i=this.fieldStateSetters.get(e);null==i||i.call(i,t)}setNumericFieldValue(e,t){let i=this.fieldStateSetters.get(e);null==i||i.call(i,t)}setBooleanFieldValue(e,t){let i=this.fieldStateSetters.get(e);null==i||i.call(i,t)}setSingleSelectFieldValue(e,t){let i=this.fieldStateSetters.get(e);null==i||i.call(i,t)}setMultiSelectFieldValue(e,t){let i=this.fieldStateSetters.get(e);null==i||i.call(i,t)}getPriceGridById(e){return this.priceGridLookup.get(e)}addMessage(e){this.messages.push(e)}getMessages(){return this.messages}addOptionMutation(e,t){this.optionState.get(e).handle(t)}addModelMutation(e){if(e instanceof U)this.subProductConfig=e.config;else if(e instanceof _)this.subProductConfig=null;else if(e instanceof H){if(this.pricingConfigOverride=e.pricingConfig,"PRICE_GRID"==this.pricingConfigOverride.mode.type){let t=e.pricingConfig.mode,i=this.priceGridLookup.get(t.priceGridId);this.setMaximumMinFromPriceGrid(i)}}else if(e instanceof G){let t=this.variableLookup.get(e.name);(null==t?void 0:t.dataType)=="NUMERIC"&&(e.maximum&&(t.maximum=e.maximum),e.minimum&&(t.minimum=e.minimum))}else e instanceof K?this.basePriceModifiers.push(e.modifier):e instanceof k&&this.optionPriceModifiers.push(e.modifier);this.modelMutations.push(e)}setMaximumMinFromPriceGrid(e){let t=e.xSpacings[0],i=e.xSpacings[e.xSpacings.length-1];if(this.addModelMutation(new G(e.xVariable,t,i)),e.yVariable){let t=e.ySpacings[0],i=e.ySpacings[e.ySpacings.length-1];this.addModelMutation(new G(e.yVariable,t,i))}}isOptionVisible(e){let t=this.optionState.get(e);return!(t.isRemoved&&t.isRemoved())&&!t.isHidden()&&this.optionIsVisibleForCurrentAudience(e)}isOptionVisibleForReporting(e,t){if(this.optionIsRemoved(e))return!1;let i=this.optionState.get(e);return!i.hidden&&this.optionIsVisibleForAudience(e,t)}subProductConfigToLoad(){return this.subProductConfig}pricingConfigurationOverride(){return this.pricingConfigOverride}getBasePriceModifiers(){return this.basePriceModifiers}getOptionPriceModifiers(){return this.optionPriceModifiers}buildComponents(){let e=t=>{if(!this.isOptionVisibleForReporting(t.id,"QUOTE"))return[];switch(t.type){case"GROUP":return t.subOptions.flatMap(e);case"DISPLAY":return[];case"TEXT":case"SELECT_SINGLE":case"SELECT_MULTI":case"NUMERIC":case"MEASUREMENT":return[this.optionState.get(t.id).buildDisplayComponent()]}};return this.productConfig.options.flatMap(e)}buildOptionSnapshot(e){let t=this.optionState.get(e);if(t instanceof o)return t.snapshot();throw Error(`option: ${e} is not an input`)}buildSnapshot(){let e=[];for(let t of this.optionState.values())t instanceof o&&!t.isRemoved()&&e.push(t.snapshot());let t=[];for(let e of this.variableLookup.values())t.push({type:e.type,dataType:e.dataType,name:e.name,value:this.getVariableValue(e.name)});let i={meta:this.productConfig.meta,initialValues:this.initialValues,options:e,variables:t,subProducts:[]};return{meta:{engineVersion:"1.0.0",productConfigVersion:"1.0.1",id:this.productConfig.meta.id},products:[i]}}isOrderable(){let e=t=>{if("GROUP"==t.type)return!!this.optionState.get(t.id).isRemoved()||!this.optionIsVisibleForCurrentAudience(t.id)||t.subOptions.every(t=>e(t));let i=this.optionState.get(t.id);if(i instanceof o){if(i.isHidden()||!this.optionIsVisibleForCurrentAudience(t.id)||!i.isMandatory())return!0;if(!i.hasValue())return!1}return!0};if(this.messages.some(e=>"ERROR"==e.level))return!1;for(let t=0;t<this.productConfig.options.length;t++)if(!e(this.productConfig.options[t]))return!1;return!0}restoreOption(e){let t=this.optionState.get(e.id);if(!t)throw Error(`no option found for id ${e.id}, ${e.name}, ${e.type}, ${e.legacyId}`);t.restore(e)}optionIsVisibleForCurrentAudience(e){return this.optionIsVisibleForAudience(e,this.environment.audience)}optionIsVisibleForAudience(e,t){let i=this.optionLookup.get(e).audienceVisibility;return(null==i?!void 0:!i.hiddenFrom.includes(t))&&((null==i?!!void 0:!!i.visibleTo.includes(t))||(null==i?!void 0:!i.hiddenFrom.includes("ALL"))&&((null==i?!!void 0:!!i.visibleTo.includes("ALL"))||!1))}optionIsRemoved(e){if(this.optionState.get(e).isRemoved())return!0;let t=this.optionParentLookup.get(e);return null!=t&&this.optionIsRemoved(t)}restoreVariables(e){e.forEach(e=>{let t=this.variableLookup.get(e.name);t&&("SYSTEM"==t.type||"USER"==t.type)&&(t.value=e.value)})}}function $(e,t){let i=Math.sign(e),a=Math.pow(10,t);return Math.round(e*a)/a*i}let j={PRODUCT_HEIGHT:"PRODUCT_HEIGHT",PRODUCT_WIDTH:"PRODUCT_WIDTH",WINDOW_WIDTH:"WINDOW_WIDTH",WINDOW_HEIGHT:"WINDOW_HEIGHT"};class X{constructor(e,t,i=!1,a){this.environment=e,this.productBundle=t,this.subEngine=i,this.currentSubEngine=null,this.engineId=d.getNext();let n=null!=a?a:t.meta.initialProductId,r=t.products.find(e=>e.meta.id==n);if(!r)throw Error(`product id: ${n} not found in bundle`);this.productConfiguration=r}initModel(e){if(this.currentModel=new q(this.productConfiguration,this.environment,e),this.productConfiguration.initModel){let e=new Q(this.productConfiguration,this.currentModel,this);this.productConfiguration.initModel(e)}}getExecutionContext(){return new Q(this.productConfiguration,this.currentModel,this)}getSubEngineExecutionContext(){var e;return null===(e=this.currentSubEngine)||void 0===e?void 0:e.getExecutionContext()}buildResults(){var e;let t=this.currentModel.subProductConfigToLoad(),i=this.execute(),n=this.currentModel.subProductConfigToLoad();if(null!=n){let i=JSON.stringify(t),r=JSON.stringify(n);if(this.currentSubEngine&&n.productId===(null===(e=this.currentSubEngine)||void 0===e?void 0:e.productConfiguration.meta.id)&&i==r){if(null!=n.variables){for(let e in n.variables){let t=n.variables[e];null!=t&&!isNaN(t)&&this.currentSubEngine.currentModel.setVariableValue(e,t)}this.currentSubEngine.buildResults()}}else{let e=null;if(this.currentSubEngine&&(e=this.currentSubEngine.publish()),this.currentSubEngine=this.createSubEngine(n.productId),e)try{this.currentSubEngine.restoreProduct(!0,e.meta,e.products[0],n.initialValues)}catch(e){console.error(e)}else this.currentSubEngine.init(n.initialValues);if(null!=n.optionValues)for(let e in n.optionValues)this.currentSubEngine.currentModel.addOptionMutation(e,new O([n.optionValues[e]])),this.currentSubEngine.currentModel.addOptionMutation(e,new a);if(null!=n.variables){for(let e in n.variables)this.currentSubEngine.currentModel.setVariableValue(e,n.variables[e]);this.currentSubEngine.buildResults()}}}else this.currentSubEngine=null;if(!this.currentSubEngine)return i;let r=this.currentSubEngine.buildResults();return i.messages.push(...r.messages),Object.assign(Object.assign({},i),{availableFields:[...i.availableFields,...r.availableFields],isOrderable:i.isOrderable&&r.isOrderable})}onFieldUpdate(e){var t;return this.currentModel.hasField(e.id)?this.setFieldValueOnState(e):null===(t=this.currentSubEngine)||void 0===t||t.onFieldUpdate(e),this.buildResults()}init(e){return this.initModel(e),this.execute()}execute(){var e,t;this.executeRules();let i=[];this.productConfiguration.options.forEach(e=>{let t=this.buildFields(e,this.currentModel);i.push(...t)});let a=this.getPricingCalculator().calculate().totalPrice;a=isNaN(a)?0:a;let n=this.currentModel.buildComponents(),r=this.currentModel.isOrderable();if(this.productBundle.products.length>1&&this.currentModel.getProductId()==this.productBundle.meta.id&&null==this.currentSubEngine&&(r=!1),this.currentSubEngine){let i=this.currentSubEngine.execute();n=[...n,...null!==(t=null===(e=i.productConfiguration[0])||void 0===e?void 0:e.components)&&void 0!==t?t:[]];let s=i.productConfiguration[0].pricing.extendedSellPriceExTax;a+=isNaN(s)?0:s,r=r&&this.currentSubEngine.currentModel.isOrderable()}let s={productConfiguration:[{id:this.productConfiguration.meta.id,partNumber:this.productConfiguration.meta.id,name:this.productConfiguration.meta.name,description:this.productConfiguration.meta.description,notes:null,components:n,pricing:{unitSellPriceExTax:this.toMoney(a),unitSellPriceIncTax:this.toMoney(1.1*a),extendedSellPriceExTax:this.toMoney(a),extendedSellPriceIncTax:this.toMoney(1.1*a)}}],availableFields:i,isOrderable:r,messages:this.currentModel.getMessages()};return this.transformResult?this.transformResult(s):s}toMoney(e){return null===e?NaN:parseFloat($(e,2).toFixed(2))}executeRules(){let e=new Q(this.productConfiguration,this.currentModel,this);this.currentModel.resetForEvaluation(),this.productConfiguration.initModel&&this.productConfiguration.initModel(e),this.productConfiguration.rules.forEach(t=>{this.executeRule(e,t)})}executeRule(e,t){t.evaluateConditions(e)?t.actionOnTrue(e):t.actionOnFalse&&t.actionOnFalse(e)}setFieldValueOnState(t){var i,a,n,r,s;switch(t.type){case e.SELECT_SINGLE:this.currentModel.setSingleSelectFieldValue(t.id,null!==(a=null===(i=t.selectedOption)||void 0===i?void 0:i.id)&&void 0!==a?a:null);break;case e.SELECT_MULTI:this.currentModel.setMultiSelectFieldValue(t.id,t.selectedOptions.map(e=>e.id));break;case e.MEASUREMENT:case e.CURRENCY:case e.QUANTITY:this.currentModel.setNumericFieldValue(t.id,null!==(n=t.value)&&void 0!==n?n:0);break;case e.BOOLEAN:this.currentModel.setBooleanFieldValue(t.id,null!==(r=t.value)&&void 0!==r&&r);break;case e.TEXT:this.currentModel.setTextFieldValue(t.id,null!==(s=t.value)&&void 0!==s?s:"");break;default:throw Error(`Unknown field type ${t.type}`)}}buildFields(t,i){if("GROUP"===t.type){if(!i.isOptionVisible(t.id))return[];let a=[];return(t.subOptions.forEach(e=>{let t=this.buildFields(e,i);a.push(...t)}),0==a.length)?[]:[{id:t.id,type:e.GROUP,name:t.name,sortOrder:t.sortOrder,fields:a,meta:t.meta,messages:null}]}{let e=i.renderOption(t.id);return e?[e]:[]}}publish(){let e=this.currentModel.buildSnapshot();if(!this.currentSubEngine)return e;let t=this.currentSubEngine.publish();return e.products[0].subProducts=t.products,e}restore(e,t){let i=e.products.find(e=>e.meta.id===this.productConfiguration.meta.id);return this.restoreProduct(!1,e.meta,i,t),{evaluationResult:this.buildResults(),messages:[]}}restoreProduct(e,t,i,a){var n;let r=this.migrateProductSnapshot(t,i);for(let t of(this.initModel(a),r.options))try{this.currentModel.restoreOption(t)}catch(t){if(!e)throw t}this.currentModel.restoreVariables(r.variables),(null===(n=i.subProducts)||void 0===n?void 0:n.length)==1&&this.buildResults();let s=this.currentModel.subProductConfigToLoad();null!==s&&(this.currentSubEngine=this.createSubEngine(s.productId),this.currentSubEngine.restoreProduct(!1,t,i.subProducts.find(e=>e.meta.id===s.productId),a))}migrateProductSnapshot(e,t){if("1.0.1"==e.productConfigVersion)return t;let i=t.variables.find(e=>e.name==j.PRODUCT_WIDTH);i&&(i.name=j.WINDOW_WIDTH);let a=t.variables.find(e=>e.name==j.PRODUCT_HEIGHT);return a&&(a.name=j.WINDOW_HEIGHT),t}order(e){throw Error("Method not implemented.")}}class J{constructor(e,t,i,a,n){this.totalPrice=e,this.totalDiscount=t,this.basePrice=i,this.optionPrice=a,this.additionalComponents=n}}class z{constructor(e,t){this.productConfig=e,this.state=t}calculate(){let e=this.calculateBasePrice(),t=this.applyBasePriceModifiers(e)+this.calculateOptionPrice();return new J(t,0,t,0,[])}calculateOptionPrice(){let e=this.state.getOptionPriceModifiers(),t=0;for(let i=0;i<e.length;i++){let a=e[i];"FLAT"==a.type&&(t+=a.value)}return t}applyBasePriceModifiers(e){let t=this.state.getBasePriceModifiers();if(0==t.length)return e;let i=e,a=t.filter(e=>"CURRENCY"==e.type);for(let e=0;e<a.length;e++)i+=a[e].value;let n=t.filter(e=>"FACTOR"==e.type);for(let e=0;e<n.length;e++)i*=n[e].value;return i}calculateBasePrice(){let e=this.productConfig.pricing,t=this.state.pricingConfigurationOverride();null!=t&&(e=t);let i=e.mode;switch(i.type){case"FREE":case"FLAT":break;case"PRICE_GRID":let a=this.state.getPriceGridById(i.priceGridId);if(null==a)throw Error(`Price grid not found: ${i.priceGridId}`);return this.evaluatePriceGrid(a);case"SQUARE_DIMENSIONS":let n=i.category,r=null;switch(n){case"MAJOR":r="SQUARE_MAJOR";break;case"MINOR":r="SQUARE_MINOR"}let s=this.state.getValueByCalculationKey(r)*i.rate;switch(i.rounding.type){case"NONE":return s;case"FLOOR":return Math.floor(s);case"CEILING":return Math.ceil(s);case"HALF_UP":return $(s,i.rounding.decimals)}}return NaN}evaluatePriceGrid(e){let t=this.state.getVariableValue(e.xVariable),i=0;if(null!=e.yVariable){let t=this.state.getVariableValue(e.yVariable);for(let a=0;a<e.ySpacings.length;a++)if(t<=e.ySpacings[a]){i=a;break}}let a=0;for(let i=0;i<e.xSpacings.length;i++)if(t<=e.xSpacings[i]){a=i;break}return e.values[i][a]}}class Z{constructor(e,t=!1){this.productAttributes=e,this.readonlyWidth=t,this.widthFieldId=d.getNext(),this.heightFieldId=d.getNext()}render(e){let t=[];if(this.productAttributes.hasWidth){let i=e.getNumericVariable(j.WINDOW_WIDTH),a=new x(this.widthFieldId).setSortOrder(1).setName("Width").setMeta("dimensions--width").setMinimum(i.minimum).setMaximum(i.maximum).setReadonly(this.readonlyWidth).setCurrentValue(e.getVariableValue(j.WINDOW_WIDTH));t.push(a.render())}if(this.productAttributes.hasHeight){let i=e.getNumericVariable(j.WINDOW_HEIGHT),a=new x(this.heightFieldId).setSortOrder(2).setName("Height").setMeta("dimensions--height").setMinimum(i.minimum).setMaximum(i.maximum).setCurrentValue(e.getVariableValue(j.WINDOW_HEIGHT));t.push(a.render())}if(1==t.length)return t[0];let i=new p("DIMENSIONS",t);return i.setMeta("dimensions"),i.render()}isDimensionField(e){return e==this.widthFieldId||e==this.heightFieldId}setValue(e,t){if(e.id==this.widthFieldId)t.setVariableValue(j.WINDOW_WIDTH,e.value);else if(e.id==this.heightFieldId)t.setVariableValue(j.WINDOW_HEIGHT,e.value);else throw Error("Unknown field id: "+e.id)}hasValues(e){let t=!0;return this.productAttributes.hasHeight&&(t=e.getVariableValue(j.WINDOW_HEIGHT)>0),this.productAttributes.hasWidth&&(t=t&&e.getVariableValue(j.WINDOW_WIDTH)>0),t}getDimensionText(e){let t=[];if(this.productAttributes.hasWidth){let i=e.getVariableValue(j.WINDOW_WIDTH);i>0&&t.push(i.toFixed(0)+"mm")}if(this.productAttributes.hasHeight){let i=e.getVariableValue(j.WINDOW_HEIGHT);i>0&&t.push(i.toFixed(0)+"mm")}return t.join(" x ")}}class ee extends X{constructor(e,t,i=!1,a){super(e,t,i,a),this.productDimensionsState=null,(this.productConfiguration.meta.attributes.hasHeight||this.productConfiguration.meta.attributes.hasWidth)&&(this.productDimensionsState=new Z(this.productConfiguration.meta.attributes))}createSubEngine(e){return new ee(this.environment,this.productBundle,!0,e)}getPricingCalculator(){return new z(this.productConfiguration,this.currentModel)}initialValueSchema(){var e;return null!==(e=this.productConfiguration.initialValues)&&void 0!==e?e:[]}onFieldUpdate(e){return this.productDimensionsState&&this.productDimensionsState.isDimensionField(e.id)?(this.productDimensionsState.setValue(e,this.currentModel),super.execute()):super.onFieldUpdate(e)}handleFabricColourField(e){return"GROUP"==e.type?Object.assign(Object.assign({},e),{fields:e.fields.map(e=>this.handleFabricColourField(e))}):("SELECT_SINGLE"==e.type&&"fabric-color"==e.meta&&(e.meta="fabric-color--blockout"),e)}transformResult(e){var t;if(!this.productDimensionsState)return e;let i=[];if("PRIMARY"==this.currentModel.getValueByCalculationKey("MOUNT_POSITION")){i.push(this.productDimensionsState.render(this.currentModel));let a=e.productConfiguration[0];a&&(null===(t=a.components)||void 0===t||t.unshift({sortOrder:-1,name:"Dimensions",value:this.productDimensionsState.getDimensionText(this.currentModel)}))}return e.availableFields=i.concat(e.availableFields).map(e=>this.convertMeasurementGroups(e)),e.isOrderable=e.isOrderable&&this.productDimensionsState.hasValues(this.currentModel),e}convertMeasurementGroups(t){if("GROUP"!=t.type)return t;if(t.fields.every(e=>"MEASUREMENT"==e.type)){let i=t.fields;return Object.assign(Object.assign({},t),{type:e.SET,fields:i,messages:[]})}let i=this;return Object.assign(Object.assign({},t),{fields:t.fields.map(e=>i.convertMeasurementGroups(e))})}}let et=new ee({apiUrl:"",apiToken:"",audience:"ECOMMERCE_FRONTEND"},{meta:{id:"66962",name:"Aluminium Venetians",description:"",lastUpdated:"2025-04-26T05:41:08",initialProductId:"66962"},products:[{meta:{id:"66962",name:"Aluminium Venetians",description:"",lastUpdated:"2025-04-26T05:41:08",attributes:{hasWidth:!1,hasHeight:!1,hasQuantity:!1,optionSyncPassthrough:!0,measurementSystem:"METRIC"}},pricing:{mode:{type:"FREE"}},options:[{legacyId:"839f536f-6301-4c69-8fe8-ba5ae70177ef",id:"839f536f-6301-4c69-8fe8-ba5ae70177ef",name:"Finish",sortOrder:0,type:"SELECT_SINGLE",meta:"finish",audienceVisibility:{visibleTo:["ALL"],hiddenFrom:[]},selects:[{legacyId:"7ca8997c-2ac8-4352-ab22-15dc58693bbf",id:"7ca8997c-2ac8-4352-ab22-15dc58693bbf",sortOrder:0,name:"finish--aluminium",manufacturerKey:"FINISH--ALUMINIUM",hasQuantity:!1,meta:"finish--aluminium"}],defaultId:null,calculationKey:"O_FINISH",manufacturerKey:"O_FINISH",required:!0},{legacyId:"4e4b0a12-9b28-47aa-9a1f-f67852f074c2",id:"4e4b0a12-9b28-47aa-9a1f-f67852f074c2",name:"TYPE",sortOrder:0,type:"SELECT_SINGLE",meta:"fabric",audienceVisibility:{visibleTo:["ALL"],hiddenFrom:[]},selects:[{legacyId:"8625984",id:"63a6a9f9-e746-4bc4-a77f-d8377f1ead89",sortOrder:0,name:"25mm Aluminium",manufacturerKey:"25mm Aluminium",hasQuantity:!1,meta:"fabric-blinds--25mm-aluminium"},{legacyId:"8626091",id:"a3fea725-7d4f-4fd2-97ff-0fb530944d7a",sortOrder:1,name:"50mm Aluminium",manufacturerKey:"Aluminium",hasQuantity:!1,meta:"fabric-blinds--50mm-aluminium"}],defaultId:"63a6a9f9-e746-4bc4-a77f-d8377f1ead89",calculationKey:"O_FABRIC",manufacturerKey:"O_FABRIC",required:!0}],initialValues:[{type:"MEASUREMENT",key:"WINDOW_WIDTH",unit:"MM",minimum:0,maximum:null,step:1},{type:"MEASUREMENT",key:"WINDOW_HEIGHT",unit:"MM",minimum:0,maximum:null,step:1}],initModel(e){e.hideSelectFieldOption("4e4b0a12-9b28-47aa-9a1f-f67852f074c2",["63a6a9f9-e746-4bc4-a77f-d8377f1ead89","a3fea725-7d4f-4fd2-97ff-0fb530944d7a"])},rules:[{id:"b0ce7ec0-6aa3-4d58-be94-6cd52cf47019",name:"",evaluateConditions:e=>e.anyOptionSelected("839f536f-6301-4c69-8fe8-ba5ae70177ef",["7ca8997c-2ac8-4352-ab22-15dc58693bbf"]),actionOnTrue(e){e.setVariableValue("FINISH_CATEGORY","finish--aluminium"),e.showSelectFieldOption("4e4b0a12-9b28-47aa-9a1f-f67852f074c2",["63a6a9f9-e746-4bc4-a77f-d8377f1ead89","a3fea725-7d4f-4fd2-97ff-0fb530944d7a"])}},{id:"c39e4e1c-041e-4999-8234-aee7c9c130b4",name:"",evaluateConditions:e=>e.anyOptionSelected("4e4b0a12-9b28-47aa-9a1f-f67852f074c2",["63a6a9f9-e746-4bc4-a77f-d8377f1ead89"]),actionOnTrue(e){var t;e.loadSubProduct({productId:"66944",initialValues:{},variables:{MOUNT_POSITION:null!==(t=e.getVariableByName("MOUNT_POSITION"))&&void 0!==t?t:"PRIMARY"},optionValues:{"5f473d41-dea4-4ac9-9c72-52e9b0e7f5c7":"63a6a9f9-e746-4bc4-a77f-d8377f1ead89"}})}},{id:"df29ad87-d5ef-4a9f-9561-148e9dafbdb3",name:"",evaluateConditions:e=>e.anyOptionSelected("4e4b0a12-9b28-47aa-9a1f-f67852f074c2",["a3fea725-7d4f-4fd2-97ff-0fb530944d7a"]),actionOnTrue(e){var t;e.loadSubProduct({productId:"66945",initialValues:{},variables:{MOUNT_POSITION:null!==(t=e.getVariableByName("MOUNT_POSITION"))&&void 0!==t?t:"PRIMARY"},optionValues:{"899fc58d-fd73-49fb-8f2a-80eafc8550bd":"a3fea725-7d4f-4fd2-97ff-0fb530944d7a"}})}}],variables:[{type:"SYSTEM",dataType:"NUMERIC",name:"WINDOW_HEIGHT",minimum:1,maximum:null,step:null,value:null},{type:"SYSTEM",dataType:"NUMERIC",name:"PRODUCT_HEIGHT",minimum:1,maximum:null,step:null,value:null},{type:"SYSTEM",dataType:"NUMERIC",name:"WINDOW_WIDTH",minimum:1,maximum:null,step:null,value:null},{type:"SYSTEM",dataType:"NUMERIC",name:"PRODUCT_WIDTH",minimum:1,maximum:null,step:null,value:null},{type:"SYSTEM",dataType:"ENUM",name:"MOUNT_POSITION",values:["PRIMARY","SECONDARY"],value:"PRIMARY"}],priceGrids:[]},{meta:{id:"66944",name:"Aluminium (25mm Standard)",description:"",lastUpdated:"2025-07-10T06:16:13",attributes:{hasWidth:!0,hasHeight:!0,hasQuantity:!0,optionSyncPassthrough:!1,measurementSystem:"METRIC"}},pricing:{mode:{type:"PRICE_GRID",priceGridId:"66944"}},options:[{legacyId:"1982143",id:"5f473d41-dea4-4ac9-9c72-52e9b0e7f5c7",name:"TYPE",sortOrder:0,type:"SELECT_SINGLE",meta:"fabric",audienceVisibility:{visibleTo:["ALL"],hiddenFrom:[]},selects:[{legacyId:"8625984",id:"63a6a9f9-e746-4bc4-a77f-d8377f1ead89",sortOrder:0,name:"25mm Aluminium",manufacturerKey:"25mm Aluminium",hasQuantity:!1,meta:"fabric-blinds--25mm-aluminium"}],defaultId:"63a6a9f9-e746-4bc4-a77f-d8377f1ead89",calculationKey:"TYPE",manufacturerKey:"TYPE",required:!0},{legacyId:"1982123",id:"46f67932-aa78-482b-bc17-8f95ac182b10",name:"Colour",sortOrder:1,type:"SELECT_SINGLE",meta:"fabric-color",audienceVisibility:{visibleTo:["ALL"],hiddenFrom:[]},selects:[{legacyId:"8625934",id:"c5ce294f-2b6f-4817-a4e5-afe1a0a8730f",sortOrder:1,name:"Black Satin",manufacturerKey:"164 BLACK SATIN",hasQuantity:!1,meta:"fabric-blinds--25mm-aluminium--black-satin"},{legacyId:"8625935",id:"bcd25dd8-aa68-4d4c-899a-139232934dd8",sortOrder:3,name:"Brushed Aluminium",manufacturerKey:"167 BRUSHED ALUMINIUM",hasQuantity:!1,meta:"fabric-blinds--25mm-aluminium--brushed-aluminium"},{legacyId:"8625936",id:"37f5d75a-6a4c-4dee-a8b9-6081a1d7880c",sortOrder:4,name:"Silver",manufacturerKey:"168 SILVER",hasQuantity:!1,meta:"fabric-blinds--25mm-aluminium--silver"},{legacyId:"8625937",id:"da7d5b65-756a-43b9-9960-e43846091ac7",sortOrder:5,name:"Basic White",manufacturerKey:"2000 BASIC WHITE",hasQuantity:!1,meta:"fabric-blinds--25mm-aluminium--basic-white"},{legacyId:"8625938",id:"2985e250-f798-49e0-a62d-0f29b5c814a0",sortOrder:11,name:"Light Cream",manufacturerKey:"3095 LIGHT CREAM",hasQuantity:!1,meta:"fabric-blinds--25mm-aluminium--light-cream"},{legacyId:"8625939",id:"b5836bed-a095-4511-bdec-3810fb568ae5",sortOrder:21,name:"China White",manufacturerKey:"797 CHINA WHITE",hasQuantity:!1,meta:"fabric-blinds--25mm-aluminium--china-white"},{legacyId:"8625940",id:"f6f477ec-ae4f-419d-8657-e654d736beae",sortOrder:22,name:"Grey Sheen",manufacturerKey:"9013 GREY SCREEN",hasQuantity:!1,meta:"fabric-blinds--25mm-aluminium--grey-sheen"},{legacyId:"8625941",id:"2199680e-24ae-4982-a7e8-e751b1a299b5",sortOrder:23,name:"Raw Silk",manufacturerKey:"904 RAW SILK",hasQuantity:!1,meta:"fabric-blinds--25mm-aluminium--raw-silk"}],defaultId:null,calculationKey:"Colour",manufacturerKey:"Colour",required:!0},{legacyId:"1982791",id:"f13eeef7-d920-44c6-a7e3-3bfa7ec45c76",name:"Fitting",sortOrder:3,type:"SELECT_SINGLE",meta:"fitting-type",audienceVisibility:{visibleTo:["ALL"],hiddenFrom:[]},selects:[{legacyId:"8628575",id:"dbaad81c-9c61-427e-bf37-dcd278c54f63",sortOrder:0,name:"Face Fit",manufacturerKey:"Face",hasQuantity:!1,meta:"fitting-type--face"},{legacyId:"8628576",id:"a2ded64a-f8a3-4e05-8398-578a43953791",sortOrder:1,name:"Recess Fit",manufacturerKey:"Recess",hasQuantity:!1,meta:"fitting-type--recess"}],defaultId:null,calculationKey:"Fixing",manufacturerKey:"Fixing",required:!0},{legacyId:"1982790",id:"d2858d92-02e6-44c9-a566-89bb8a4b9061",name:"Control Side",sortOrder:4,type:"SELECT_SINGLE",meta:"control-side",audienceVisibility:{visibleTo:["ALL"],hiddenFrom:[]},selects:[{legacyId:"8628570",id:"cfd2b77b-ff39-4abb-a074-6e54c6c15bd6",sortOrder:0,name:"Left",manufacturerKey:"LC",hasQuantity:!1,meta:"control-side--left"},{legacyId:"8628571",id:"1412eefb-a55b-4d7a-85ab-9c861dbdf03d",sortOrder:1,name:"Right",manufacturerKey:"RC",hasQuantity:!1,meta:"control-side--right"}],defaultId:null,calculationKey:"Control Type",manufacturerKey:"Control Type",required:!0},{legacyId:"1982789",id:"f625bcde-8533-472c-ae0b-ae9bec5c3396",name:"Control Length",sortOrder:5,type:"SELECT_SINGLE",meta:null,audienceVisibility:{visibleTo:["ALL"],hiddenFrom:["CONFIGURATOR","ECOMMERCE_FRONTEND"]},selects:[{legacyId:"8628561",id:"3ef57438-78f1-4800-8b71-1b24f06bbf30",sortOrder:100,name:"STD",manufacturerKey:"STD",hasQuantity:!1,meta:null},{legacyId:"8628562",id:"5b59fb62-6dee-46fc-980c-87d1fa58baa7",sortOrder:100,name:"500mm",manufacturerKey:"500",hasQuantity:!1,meta:null},{legacyId:"8628563",id:"a9f34433-dd24-4595-a699-18c68e620ecd",sortOrder:100,name:"750mm",manufacturerKey:"750",hasQuantity:!1,meta:null},{legacyId:"8628564",id:"ea14eb90-250d-4d2d-b710-1132c2765af7",sortOrder:100,name:"1000mm",manufacturerKey:"1000",hasQuantity:!1,meta:null},{legacyId:"8628565",id:"cbc255a8-abc3-47ba-a580-cc0e465b2fa9",sortOrder:100,name:"1250mm",manufacturerKey:"1250",hasQuantity:!1,meta:null},{legacyId:"8628566",id:"7b705562-6c23-41f3-9a7c-99e78894fd7d",sortOrder:100,name:"1500mm",manufacturerKey:"1500",hasQuantity:!1,meta:null},{legacyId:"8628567",id:"788f91db-e7d8-43d6-9e44-3301a37c42df",sortOrder:100,name:"1750mm",manufacturerKey:"1750",hasQuantity:!1,meta:null},{legacyId:"8628568",id:"7357f69d-f240-4788-ba61-337f7c2f4df4",sortOrder:100,name:"2000mm",manufacturerKey:"2000",hasQuantity:!1,meta:null},{legacyId:"8628569",id:"c01fb4b1-fc2c-4b80-b970-0eff576121af",sortOrder:100,name:"2250mm",manufacturerKey:"2250",hasQuantity:!1,meta:null}],defaultId:"3ef57438-78f1-4800-8b71-1b24f06bbf30",calculationKey:"Control Length",manufacturerKey:"Control Length",required:!0},{legacyId:"1982793",id:"943a3e74-ee81-429b-a322-2cceffc042fa",name:"Woven Tape",sortOrder:6,type:"SELECT_SINGLE",meta:null,audienceVisibility:{visibleTo:["ALL"],hiddenFrom:["CONFIGURATOR","ECOMMERCE_FRONTEND"]},selects:[{legacyId:"8628579",id:"83c15402-984a-4a03-bbbe-47a67fb0a138",sortOrder:0,name:"25mm Woven tape",manufacturerKey:"25mm woven tape",hasQuantity:!1,meta:null},{legacyId:"8628580",id:"c034ca12-8c27-4a0b-b561-6ff4a5a7b9ef",sortOrder:1,name:"N/A",manufacturerKey:"N/A",hasQuantity:!1,meta:null}],defaultId:"c034ca12-8c27-4a0b-b561-6ff4a5a7b9ef",calculationKey:"Woven tape",manufacturerKey:"Woven tape",required:!1},{legacyId:"1982792",id:"13c962a8-7a63-4a9a-b0f8-47359edd05a1",name:"Hold Down Clips",sortOrder:7,type:"SELECT_SINGLE",meta:null,audienceVisibility:{visibleTo:["ALL"],hiddenFrom:["CONFIGURATOR","ECOMMERCE_FRONTEND"]},selects:[{legacyId:"8628577",id:"719034c8-f124-4b38-8a9e-91cc5447b50f",sortOrder:0,name:"Yes",manufacturerKey:"Yes",hasQuantity:!1,meta:null},{legacyId:"8628578",id:"39a1860a-96ad-4c6d-80eb-cd0ae95e2bea",sortOrder:1,name:"N/A",manufacturerKey:"N/A",hasQuantity:!1,meta:null}],defaultId:"39a1860a-96ad-4c6d-80eb-cd0ae95e2bea",calculationKey:"Hold Down Clips",manufacturerKey:"Hold Down Clips",required:!1},{legacyId:"1982794",id:"9546f0b2-e85f-4f0a-ac29-b0c3365c797e",name:"Cut Outs",sortOrder:8,type:"SELECT_SINGLE",meta:null,audienceVisibility:{visibleTo:["ALL"],hiddenFrom:["CONFIGURATOR","ECOMMERCE_FRONTEND"]},selects:[{legacyId:"8628581",id:"95afa658-8464-4eb8-9a2f-4fbfb488eca4",sortOrder:0,name:"Yes",manufacturerKey:"Yes",hasQuantity:!1,meta:null},{legacyId:"8628582",id:"ed233580-4daa-4ec4-96ed-6f2601e685ac",sortOrder:1,name:"N/A",manufacturerKey:"N/A",hasQuantity:!1,meta:null}],defaultId:"ed233580-4daa-4ec4-96ed-6f2601e685ac",calculationKey:"Cutout",manufacturerKey:"Cutout",required:!1},{legacyId:"1982795",id:"d671ff3c-4185-4361-82bc-9180b38168c9",name:"Between Glass",sortOrder:9,type:"SELECT_SINGLE",meta:null,audienceVisibility:{visibleTo:["ALL"],hiddenFrom:["CONFIGURATOR","ECOMMERCE_FRONTEND"]},selects:[{legacyId:"8628583",id:"3c56e76a-9ce0-400d-bf3b-1130dba7b87c",sortOrder:0,name:"Yes",manufacturerKey:"Yes",hasQuantity:!1,meta:null},{legacyId:"8628584",id:"3ed7bbca-3890-4b59-87bc-ab513fb28117",sortOrder:1,name:"N/A",manufacturerKey:"N/A",hasQuantity:!1,meta:null}],defaultId:"3ed7bbca-3890-4b59-87bc-ab513fb28117",calculationKey:"Between Glass",manufacturerKey:"Between Glass",required:!1},{legacyId:"2009941",id:"179a57b0-98cb-48f2-9bb2-c7285656b552",name:"Type",sortOrder:10,type:"SELECT_SINGLE",meta:"finish",audienceVisibility:{visibleTo:["ALL"],hiddenFrom:[]},selects:[{legacyId:"8730443",id:"486c22bb-c7f0-46e0-84d4-482f4dc43d08",sortOrder:0,name:"Aluminium",manufacturerKey:"25mm Aluminium",hasQuantity:!1,meta:"finish--aluminium"}],defaultId:"486c22bb-c7f0-46e0-84d4-482f4dc43d08",calculationKey:"TYPE",manufacturerKey:"TYPE",required:!0},{legacyId:"1982125",id:"56c206c8-d933-4161-99b7-05def138c041",name:"Extras and Notes",sortOrder:11,type:"TEXT",meta:null,audienceVisibility:{visibleTo:[],hiddenFrom:["ALL"]},default:null,multiline:!0,hasPrice:!1,maxLength:1024,calculationKey:"orderDescription",manufacturerKey:"orderDescription",required:!1}],initialValues:[{type:"MEASUREMENT",key:"WINDOW_WIDTH",unit:"MM",minimum:0,maximum:null,step:1},{type:"MEASUREMENT",key:"WINDOW_HEIGHT",unit:"MM",minimum:0,maximum:null,step:1}],initModel(e){e.setVariableValue("PRODUCT_WIDTH",e.getVariableByName("WINDOW_WIDTH")),e.setVariableValue("PRODUCT_HEIGHT",e.getVariableByName("WINDOW_HEIGHT")),300>e.getVariableByName("WINDOW_HEIGHT")&&120>e.getVariableByName("WINDOW_WIDTH")&&e.anyOptionSelected("5f473d41-dea4-4ac9-9c72-52e9b0e7f5c7",["63a6a9f9-e746-4bc4-a77f-d8377f1ead89"])&&e.addOptionMessage("5f473d41-dea4-4ac9-9c72-52e9b0e7f5c7","ERROR","Minimum size requirement not met for TYPE 25mm Aluminium"),e.hideOption("943a3e74-ee81-429b-a322-2cceffc042fa"),e.hideOption("5f473d41-dea4-4ac9-9c72-52e9b0e7f5c7")},rules:[{id:"2346325",name:"",evaluateConditions:e=>e.anyOptionSelected("f13eeef7-d920-44c6-a7e3-3bfa7ec45c76",["a2ded64a-f8a3-4e05-8398-578a43953791"]),actionOnTrue(e){e.addMessage("INFO","Headrail to be same size as slats")}},{id:"49478102-94d5-4ba9-a93b-873521fc9ddb",name:"",evaluateConditions:e=>e.anyOptionSelected("943a3e74-ee81-429b-a322-2cceffc042fa",["83c15402-984a-4a03-bbbe-47a67fb0a138"]),actionOnTrue(e){e.addBasePriceModifier({type:"FACTOR",value:1.15})}},{id:"d42bea02-b7ce-44a6-92b5-bbe2167575fd",name:"",evaluateConditions:e=>e.anyOptionSelected("9546f0b2-e85f-4f0a-ac29-b0c3365c797e",["95afa658-8464-4eb8-9a2f-4fbfb488eca4"]),actionOnTrue(e){e.addOptionPriceModifier({type:"FLAT",optionId:"9546f0b2-e85f-4f0a-ac29-b0c3365c797e",selectId:"95afa658-8464-4eb8-9a2f-4fbfb488eca4",value:10})}},{id:"cfdc8739-e2f7-44f7-905a-bc28fb94f5fd",name:"",evaluateConditions:e=>e.anyOptionSelected("d671ff3c-4185-4361-82bc-9180b38168c9",["3c56e76a-9ce0-400d-bf3b-1130dba7b87c"]),actionOnTrue(e){e.addOptionPriceModifier({type:"FLAT",optionId:"d671ff3c-4185-4361-82bc-9180b38168c9",selectId:"3c56e76a-9ce0-400d-bf3b-1130dba7b87c",value:20})}},{id:"e6319972-b9fe-480d-9900-50a5d8eaa1ca",name:"",evaluateConditions:e=>!0,actionOnTrue(e){e.hideOption("5f473d41-dea4-4ac9-9c72-52e9b0e7f5c7")}}],variables:[{type:"SYSTEM",dataType:"NUMERIC",name:"WINDOW_HEIGHT",minimum:1,maximum:null,step:null,value:null},{type:"SYSTEM",dataType:"NUMERIC",name:"PRODUCT_HEIGHT",minimum:1,maximum:null,step:null,value:null},{type:"SYSTEM",dataType:"NUMERIC",name:"WINDOW_WIDTH",minimum:1,maximum:null,step:null,value:null},{type:"SYSTEM",dataType:"NUMERIC",name:"PRODUCT_WIDTH",minimum:1,maximum:null,step:null,value:null},{type:"SYSTEM",dataType:"ENUM",name:"MOUNT_POSITION",values:["PRIMARY","SECONDARY"],value:"PRIMARY"},{type:"COMPUTED",dataType:"ANY",name:"SQUARE_MAJOR",calculate:e=>e.getVariableByName("PRODUCT_WIDTH")*e.getVariableByName("PRODUCT_HEIGHT")/1e6},{type:"COMPUTED",dataType:"ANY",name:"SQUARE_MINOR",calculate:e=>e.getVariableByName("PRODUCT_WIDTH")*e.getVariableByName("PRODUCT_HEIGHT")},{type:"COMPUTED",dataType:"ANY",name:"CUT_WIDTH",calculate:e=>e.getValueByCalculationKey("PRODUCT_WIDTH")-5},{type:"COMPUTED",dataType:"ANY",name:"CUT_DROP",calculate:e=>e.getValueByCalculationKey("PRODUCT_HEIGHT")-5},{type:"SYSTEM",dataType:"STRING",name:"FINISH_CATEGORY"}],priceGrids:[{id:"66944",xVariable:"WINDOW_WIDTH",xSpacings:[600,750,900,1050,1200,1350,1500,1650,1800,1950,2100,2250,2400,2550,2700,2850,3e3],yVariable:"WINDOW_HEIGHT",ySpacings:[600,750,900,1050,1200,1350,1500,1650,1800,1950,2100,2250,2400,2550,2700,2850,3e3],values:[[71,75,83,89,92,95,105,113,116,123,129,132,141,147,152,157,165],[73,77,84,92,95,100,113,116,121,125,136,144,148,157,162,165,175],[75,80,85,95,98,105,121,125,129,132,144,147,152,165,168,175,187],[77,82,87,98,100,113,125,129,132,136,152,157,162,175,180,184,198],[80,84,89,100,113,116,129,132,144,147,162,165,168,184,187,198,212],[82,89,92,105,116,121,132,144,147,152,168,175,180,193,203,206,220],[84,91,95,113,121,125,144,147,157,162,175,184,187,203,212,216,228],[89,92,100,116,125,132,147,157,162,168,184,193,198,216,220,228,244],[91,95,102,121,129,136,152,162,168,175,193,198,206,224,228,238,252],[92,98,105,125,132,144,162,165,175,184,198,206,216,233,238,248,266],[93,100,113,129,136,147,165,175,184,193,206,216,224,244,252,260,273],[95,105,116,132,144,152,168,180,187,198,216,224,233,252,260,269,289],[98,111,121,136,147,157,175,184,198,206,224,233,244,260,269,279,298],[100,113,123,141,152,165,184,193,203,212,228,244,252,269,279,289,305],[102,116,125,144,157,168,187,198,212,220,238,248,260,279,289,302,321],[105,119,129,147,162,175,193,206,216,228,248,257,269,289,298,311,331],[109,121,132,152,165,180,198,212,220,233,252,266,279,298,311,321,342]]}]},{meta:{id:"66945",name:"Aluminium (50mm)",description:"",lastUpdated:"2025-07-10T06:16:08",attributes:{hasWidth:!0,hasHeight:!0,hasQuantity:!0,optionSyncPassthrough:!1,measurementSystem:"METRIC"}},pricing:{mode:{type:"PRICE_GRID",priceGridId:"66945"}},options:[{legacyId:"1982168",id:"899fc58d-fd73-49fb-8f2a-80eafc8550bd",name:"TYPE",sortOrder:0,type:"SELECT_SINGLE",meta:"fabric",audienceVisibility:{visibleTo:["ALL"],hiddenFrom:["ECOMMERCE_FRONTEND"]},selects:[{legacyId:"8626091",id:"a3fea725-7d4f-4fd2-97ff-0fb530944d7a",sortOrder:0,name:"50mm Aluminium",manufacturerKey:"Aluminium",hasQuantity:!1,meta:"fabric-blinds--50mm-aluminium"}],defaultId:"a3fea725-7d4f-4fd2-97ff-0fb530944d7a",calculationKey:"TYPE",manufacturerKey:"TYPE",required:!0},{legacyId:"1982157",id:"72213b7a-4463-48b1-9594-b76f2e21fe0f",name:"Colour",sortOrder:1,type:"SELECT_SINGLE",meta:"fabric-color",audienceVisibility:{visibleTo:["ALL"],hiddenFrom:[]},selects:[{legacyId:"8626062",id:"326c4a73-7ad8-44ce-b725-64f9fd600ee7",sortOrder:1,name:"Basic White",manufacturerKey:"2000 BASIC WHITE",hasQuantity:!1,meta:"fabric-blinds--50mm-aluminium--basic-white"},{legacyId:"8626063",id:"8c4e72ce-f5ea-43c3-a6e7-0289774b8e53",sortOrder:2,name:"Brushed Aluminium",manufacturerKey:"167 BRUSHED ALUMINIUM",hasQuantity:!1,meta:"fabric-blinds--50mm-aluminium--brushed-aluminium"},{legacyId:"8626064",id:"21b878d8-d3d2-48bc-92a5-2b6b6b7c19ee",sortOrder:3,name:"Black Satin",manufacturerKey:"164 BLACK SATIN",hasQuantity:!1,meta:"fabric-blinds--50mm-aluminium--black-satin"}],defaultId:null,calculationKey:"Colour",manufacturerKey:"Colour",required:!0},{legacyId:"1982799",id:"f13eeef7-d920-44c6-a7e3-3bfa7ec45c76",name:"Fitting",sortOrder:3,type:"SELECT_SINGLE",meta:"fitting-type",audienceVisibility:{visibleTo:["ALL"],hiddenFrom:[]},selects:[{legacyId:"8628601",id:"dbaad81c-9c61-427e-bf37-dcd278c54f63",sortOrder:0,name:"Face Fit",manufacturerKey:"Face",hasQuantity:!1,meta:"fitting-type--face"},{legacyId:"8628602",id:"a2ded64a-f8a3-4e05-8398-578a43953791",sortOrder:1,name:"Recess Fit",manufacturerKey:"Recess",hasQuantity:!1,meta:"fitting-type--recess"}],defaultId:null,calculationKey:"Fixing",manufacturerKey:"Fixing",required:!0},{legacyId:"1982798",id:"d2858d92-02e6-44c9-a566-89bb8a4b9061",name:"Control Side",sortOrder:4,type:"SELECT_SINGLE",meta:"control-side",audienceVisibility:{visibleTo:["ALL"],hiddenFrom:[]},selects:[{legacyId:"8628596",id:"cfd2b77b-ff39-4abb-a074-6e54c6c15bd6",sortOrder:0,name:"Left",manufacturerKey:"LC",hasQuantity:!1,meta:"control-side--left"},{legacyId:"8628597",id:"1412eefb-a55b-4d7a-85ab-9c861dbdf03d",sortOrder:1,name:"Right",manufacturerKey:"RC",hasQuantity:!1,meta:"control-side--right"}],defaultId:null,calculationKey:"Control Type",manufacturerKey:"Control Type",required:!0},{legacyId:"1982797",id:"f625bcde-8533-472c-ae0b-ae9bec5c3396",name:"Control Length",sortOrder:5,type:"SELECT_SINGLE",meta:null,audienceVisibility:{visibleTo:["ALL"],hiddenFrom:["CONFIGURATOR","ECOMMERCE_FRONTEND"]},selects:[{legacyId:"8628587",id:"3ef57438-78f1-4800-8b71-1b24f06bbf30",sortOrder:100,name:"STD",manufacturerKey:"STD",hasQuantity:!1,meta:null},{legacyId:"8628588",id:"5b59fb62-6dee-46fc-980c-87d1fa58baa7",sortOrder:100,name:"500mm",manufacturerKey:"500",hasQuantity:!1,meta:null},{legacyId:"8628589",id:"a9f34433-dd24-4595-a699-18c68e620ecd",sortOrder:100,name:"750mm",manufacturerKey:"750",hasQuantity:!1,meta:null},{legacyId:"8628590",id:"ea14eb90-250d-4d2d-b710-1132c2765af7",sortOrder:100,name:"1000mm",manufacturerKey:"1000",hasQuantity:!1,meta:null},{legacyId:"8628591",id:"cbc255a8-abc3-47ba-a580-cc0e465b2fa9",sortOrder:100,name:"1250mm",manufacturerKey:"1250",hasQuantity:!1,meta:null},{legacyId:"8628592",id:"7b705562-6c23-41f3-9a7c-99e78894fd7d",sortOrder:100,name:"1500mm",manufacturerKey:"1500",hasQuantity:!1,meta:null},{legacyId:"8628593",id:"788f91db-e7d8-43d6-9e44-3301a37c42df",sortOrder:100,name:"1750mm",manufacturerKey:"1750",hasQuantity:!1,meta:null},{legacyId:"8628594",id:"7357f69d-f240-4788-ba61-337f7c2f4df4",sortOrder:100,name:"2000mm",manufacturerKey:"2000",hasQuantity:!1,meta:null},{legacyId:"8628595",id:"c01fb4b1-fc2c-4b80-b970-0eff576121af",sortOrder:100,name:"2250mm",manufacturerKey:"2250",hasQuantity:!1,meta:null}],defaultId:"3ef57438-78f1-4800-8b71-1b24f06bbf30",calculationKey:"Control Length",manufacturerKey:"Control Length",required:!0},{legacyId:"1982801",id:"943a3e74-ee81-429b-a322-2cceffc042fa",name:"Woven Tape",sortOrder:6,type:"SELECT_SINGLE",meta:null,audienceVisibility:{visibleTo:["ALL"],hiddenFrom:["CONFIGURATOR","ECOMMERCE_FRONTEND"]},selects:[{legacyId:"8628605",id:"83c15402-984a-4a03-bbbe-47a67fb0a138",sortOrder:0,name:"25mm Woven tape",manufacturerKey:"25mm woven tape",hasQuantity:!1,meta:null},{legacyId:"8628606",id:"c034ca12-8c27-4a0b-b561-6ff4a5a7b9ef",sortOrder:1,name:"N/A",manufacturerKey:"N/A",hasQuantity:!1,meta:null}],defaultId:"c034ca12-8c27-4a0b-b561-6ff4a5a7b9ef",calculationKey:"Woven tape",manufacturerKey:"Woven tape",required:!1},{legacyId:"1982800",id:"13c962a8-7a63-4a9a-b0f8-47359edd05a1",name:"Hold Down Clips",sortOrder:7,type:"SELECT_SINGLE",meta:null,audienceVisibility:{visibleTo:["ALL"],hiddenFrom:["CONFIGURATOR","ECOMMERCE_FRONTEND"]},selects:[{legacyId:"8628603",id:"719034c8-f124-4b38-8a9e-91cc5447b50f",sortOrder:0,name:"Yes",manufacturerKey:"Yes",hasQuantity:!1,meta:null},{legacyId:"8628604",id:"39a1860a-96ad-4c6d-80eb-cd0ae95e2bea",sortOrder:1,name:"N/A",manufacturerKey:"N/A",hasQuantity:!1,meta:null}],defaultId:"39a1860a-96ad-4c6d-80eb-cd0ae95e2bea",calculationKey:"Hold Down Clips",manufacturerKey:"Hold Down Clips",required:!1},{legacyId:"1982802",id:"9546f0b2-e85f-4f0a-ac29-b0c3365c797e",name:"Cut Outs",sortOrder:8,type:"SELECT_SINGLE",meta:null,audienceVisibility:{visibleTo:["ALL"],hiddenFrom:["CONFIGURATOR","ECOMMERCE_FRONTEND"]},selects:[{legacyId:"8628607",id:"95afa658-8464-4eb8-9a2f-4fbfb488eca4",sortOrder:0,name:"Yes",manufacturerKey:"Yes",hasQuantity:!1,meta:null},{legacyId:"8628608",id:"ed233580-4daa-4ec4-96ed-6f2601e685ac",sortOrder:1,name:"N/A",manufacturerKey:"N/A",hasQuantity:!1,meta:null}],defaultId:"ed233580-4daa-4ec4-96ed-6f2601e685ac",calculationKey:"Cutout",manufacturerKey:"Cutout",required:!1},{legacyId:"1982803",id:"d671ff3c-4185-4361-82bc-9180b38168c9",name:"Between Glass",sortOrder:9,type:"SELECT_SINGLE",meta:null,audienceVisibility:{visibleTo:["ALL"],hiddenFrom:["CONFIGURATOR","ECOMMERCE_FRONTEND"]},selects:[{legacyId:"8628609",id:"3c56e76a-9ce0-400d-bf3b-1130dba7b87c",sortOrder:0,name:"Yes",manufacturerKey:"Yes",hasQuantity:!1,meta:null},{legacyId:"8628610",id:"3ed7bbca-3890-4b59-87bc-ab513fb28117",sortOrder:1,name:"N/A",manufacturerKey:"N/A",hasQuantity:!1,meta:null}],defaultId:"3ed7bbca-3890-4b59-87bc-ab513fb28117",calculationKey:"Between Glass",manufacturerKey:"Between Glass",required:!1},{legacyId:"2009942",id:"179a57b0-98cb-48f2-9bb2-c7285656b552",name:"Type",sortOrder:10,type:"SELECT_SINGLE",meta:"finish",audienceVisibility:{visibleTo:["ALL"],hiddenFrom:[]},selects:[{legacyId:"8730444",id:"486c22bb-c7f0-46e0-84d4-482f4dc43d08",sortOrder:0,name:"Aluminium",manufacturerKey:"25mm Aluminium",hasQuantity:!1,meta:"finish--aluminium"}],defaultId:"486c22bb-c7f0-46e0-84d4-482f4dc43d08",calculationKey:"TYPE",manufacturerKey:"TYPE",required:!0},{legacyId:"1982158",id:"9c6f5466-46e8-4b0a-9c39-3952a0f6733e",name:"Extras and Notes",sortOrder:11,type:"TEXT",meta:null,audienceVisibility:{visibleTo:[],hiddenFrom:["ALL"]},default:null,multiline:!0,hasPrice:!1,maxLength:1024,calculationKey:"orderDescription",manufacturerKey:"orderDescription",required:!1}],initialValues:[{type:"MEASUREMENT",key:"WINDOW_WIDTH",unit:"MM",minimum:0,maximum:null,step:1},{type:"MEASUREMENT",key:"WINDOW_HEIGHT",unit:"MM",minimum:0,maximum:null,step:1}],initModel(e){e.setVariableValue("PRODUCT_WIDTH",e.getVariableByName("WINDOW_WIDTH")),e.setVariableValue("PRODUCT_HEIGHT",e.getVariableByName("WINDOW_HEIGHT")),300>e.getVariableByName("WINDOW_HEIGHT")&&250>e.getVariableByName("WINDOW_WIDTH")&&e.anyOptionSelected("899fc58d-fd73-49fb-8f2a-80eafc8550bd",["a3fea725-7d4f-4fd2-97ff-0fb530944d7a"])&&e.addOptionMessage("899fc58d-fd73-49fb-8f2a-80eafc8550bd","ERROR","Minimum size requirement not met for TYPE 50mm Aluminium"),e.hideOption("d671ff3c-4185-4361-82bc-9180b38168c9"),e.hideOption("899fc58d-fd73-49fb-8f2a-80eafc8550bd")},rules:[{id:"2346334",name:"",evaluateConditions:e=>e.anyOptionSelected("f13eeef7-d920-44c6-a7e3-3bfa7ec45c76",["a2ded64a-f8a3-4e05-8398-578a43953791"]),actionOnTrue(e){e.addMessage("INFO","Headrail to be same size as slats")}},{id:"65ad13af-7b69-4565-b087-2794f940b6e1",name:"",evaluateConditions:e=>e.anyOptionSelected("943a3e74-ee81-429b-a322-2cceffc042fa",["83c15402-984a-4a03-bbbe-47a67fb0a138"]),actionOnTrue(e){e.addBasePriceModifier({type:"FACTOR",value:1.15})}},{id:"76824088-2bc2-4770-a4b7-7da4be4afc17",name:"",evaluateConditions:e=>e.anyOptionSelected("9546f0b2-e85f-4f0a-ac29-b0c3365c797e",["95afa658-8464-4eb8-9a2f-4fbfb488eca4"]),actionOnTrue(e){e.addOptionPriceModifier({type:"FLAT",optionId:"9546f0b2-e85f-4f0a-ac29-b0c3365c797e",selectId:"95afa658-8464-4eb8-9a2f-4fbfb488eca4",value:10})}},{id:"894ef30f-dda0-42f5-9c7f-8f50328fbe3b",name:"",evaluateConditions:e=>e.anyOptionSelected("d671ff3c-4185-4361-82bc-9180b38168c9",["3c56e76a-9ce0-400d-bf3b-1130dba7b87c"]),actionOnTrue(e){e.addOptionPriceModifier({type:"FLAT",optionId:"d671ff3c-4185-4361-82bc-9180b38168c9",selectId:"3c56e76a-9ce0-400d-bf3b-1130dba7b87c",value:20})}},{id:"4ccc5d64-1fb5-4c7f-bc3b-68e8ec9df819",name:"",evaluateConditions:e=>!0,actionOnTrue(e){e.hideOption("899fc58d-fd73-49fb-8f2a-80eafc8550bd")}}],variables:[{type:"SYSTEM",dataType:"NUMERIC",name:"WINDOW_HEIGHT",minimum:1,maximum:null,step:null,value:null},{type:"SYSTEM",dataType:"NUMERIC",name:"PRODUCT_HEIGHT",minimum:1,maximum:null,step:null,value:null},{type:"SYSTEM",dataType:"NUMERIC",name:"WINDOW_WIDTH",minimum:1,maximum:null,step:null,value:null},{type:"SYSTEM",dataType:"NUMERIC",name:"PRODUCT_WIDTH",minimum:1,maximum:null,step:null,value:null},{type:"SYSTEM",dataType:"ENUM",name:"MOUNT_POSITION",values:["PRIMARY","SECONDARY"],value:"PRIMARY"},{type:"COMPUTED",dataType:"ANY",name:"SQUARE_MAJOR",calculate:e=>e.getVariableByName("PRODUCT_WIDTH")*e.getVariableByName("PRODUCT_HEIGHT")/1e6},{type:"COMPUTED",dataType:"ANY",name:"SQUARE_MINOR",calculate:e=>e.getVariableByName("PRODUCT_WIDTH")*e.getVariableByName("PRODUCT_HEIGHT")},{type:"COMPUTED",dataType:"ANY",name:"CUT_WIDTH",calculate:e=>e.getValueByCalculationKey("PRODUCT_WIDTH")-8},{type:"COMPUTED",dataType:"ANY",name:"CUT_DROP",calculate:e=>e.getValueByCalculationKey("PRODUCT_HEIGHT")-8},{type:"SYSTEM",dataType:"STRING",name:"FINISH_CATEGORY"}],priceGrids:[{id:"66945",xVariable:"WINDOW_WIDTH",xSpacings:[600,750,900,1050,1200,1350,1500,1650,1800,1950,2100,2250,2400,2550,2700,2850,3e3],yVariable:"WINDOW_HEIGHT",ySpacings:[600,750,900,1050,1200,1350,1500,1650,1800,1950,2100,2250,2400,2550,2700,2850,3e3],values:[[101,106,110,115,118,124,130,135,141,145,148,151,157,160,165,169,174],[106,110,115,118,124,130,135,141,148,151,154,160,165,169,174,181,184],[110,115,118,121,127,135,145,148,151,157,160,169,174,181,184,191,196],[115,118,121,124,130,145,148,154,157,165,174,177,184,188,196,199,205],[118,120,124,130,135,148,154,157,165,174,181,184,191,199,202,209,218],[121,124,127,135,141,151,157,165,174,181,188,191,199,205,215,221,229],[124,130,135,141,148,157,165,174,181,188,196,202,209,218,221,232,239],[127,135,141,145,151,160,169,177,184,196,202,209,218,226,232,239,252],[130,141,145,148,154,169,177,184,191,202,209,218,226,235,243,252,259],[135,145,148,151,157,174,181,191,199,209,218,226,235,243,252,263,269],[141,148,151,154,160,177,188,196,205,218,226,235,243,256,263,272,280],[145,151,154,157,169,184,191,202,215,226,232,243,252,263,272,285,293],[148,154,157,160,174,188,199,209,218,232,239,252,263,272,280,293,302],[151,157,160,165,177,196,202,215,226,235,246,259,269,280,293,302,315],[154,160,165,169,181,199,209,221,232,243,256,266,276,290,302,315,326],[157,165,169,174,184,202,218,229,239,252,266,276,290,299,309,326,337],[160,169,174,177,191,209,221,232,246,259,272,285,296,306,322,332,348]]}]}]}),ei={init:()=>et.init(),onFieldUpdate:e=>et.onFieldUpdate(e),order:e=>et.order(e),publish:()=>et.publish(),restore:e=>et.restore(e),initialValueSchema:()=>et.initialValueSchema()};export{ei as default};
//# sourceMappingURL=bundle.js.map